{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _createClass from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\Users\\\\shaii\\\\Desktop\\\\projects\\\\MrC\\\\src\\\\components\\\\ServiceProviderHome.js\";\nimport React, { Component, useState } from 'react';\nimport './ServiceProviderHome.css';\nimport { Redirect } from \"react-router-dom\";\nimport Header from './Header';\nimport Footer from './Footer';\nimport Error from './Error';\nimport Web3 from 'web3';\nimport Permissions from '../abis/Permissions.json';\nimport Modal from 'react-bootstrap/Modal';\n\nvar ServiceProviderHome = /*#__PURE__*/function (_Component) {\n  _inherits(ServiceProviderHome, _Component);\n\n  _createClass(ServiceProviderHome, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.loadWeb3();\n\n              case 2:\n                _context.next = 4;\n                return this.loadBlockchainData();\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!window.ethereum) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                window.web3 = new Web3(window.ethereum);\n                _context2.next = 4;\n                return window.ethereum.enable();\n\n              case 4:\n                _context2.next = 7;\n                break;\n\n              case 6:\n                if (window.web3) {\n                  window.web3 = new Web3(window.web3.currentProvider);\n                } else {\n                  window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n                }\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n\n      return loadWeb3;\n    }()\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var web3, networkId, networkData, permissions;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                web3 = window.web3;\n                _context3.next = 3;\n                return web3.eth.net.getId();\n\n              case 3:\n                networkId = _context3.sent;\n                networkData = Permissions.networks[networkId];\n\n                if (networkData) {\n                  permissions = web3.eth.Contract(Permissions.abi, networkData.address);\n                  this.setState({\n                    permissions: permissions\n                  });\n                } else {\n                  window.alert('MrC contract not deployed to detected network.');\n                }\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n\n      return loadBlockchainData;\n    }()\n  }]);\n\n  function ServiceProviderHome(props) {\n    var _this;\n\n    _classCallCheck(this, ServiceProviderHome);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ServiceProviderHome).call(this, props));\n    _this.state = {\n      account: localStorage.getItem('account'),\n      hasPermission: false,\n      patientAccount: '',\n      loadingPatient: false,\n      hasError: false\n    };\n    _this.searchOnClick = _this.searchOnClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.checkPermission = _this.checkPermission.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(ServiceProviderHome, [{\n    key: \"checkPermission\",\n    value: function () {\n      var _checkPermission = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var check;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!(this.state.patientAccount !== \"\" && this.state.patientAccount !== undefined)) {\n                  _context4.next = 5;\n                  break;\n                }\n\n                _context4.next = 3;\n                return this.state.permissions.methods.havePermission(this.state.patientAccount).call({\n                  from: this.state.account\n                });\n\n              case 3:\n                check = _context4.sent;\n\n                if (check) {\n                  this.setState({\n                    hasPermission: true\n                  });\n                } else {\n                  window.alert(\"Sorry! you don't have permission!!\");\n                } //   }\n                //else{\n                //    window.alert(\"Please enter illegal address!\")\n                // }\n\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function checkPermission() {\n        return _checkPermission.apply(this, arguments);\n      }\n\n      return checkPermission;\n    }()\n  }, {\n    key: \"searchOnClick\",\n    value: function () {\n      var _searchOnClick = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var search;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                search = document.getElementById('searchInput'); // check if have permission \n\n                this.setState({\n                  loadingPatient: true\n                });\n\n                if (!(search !== undefined && search.value !== '')) {\n                  _context5.next = 8;\n                  break;\n                }\n\n                this.setState({\n                  patientAccount: search.value\n                });\n                _context5.next = 6;\n                return this.checkPermission();\n\n              case 6:\n                _context5.next = 10;\n                break;\n\n              case 8:\n                this.setState({\n                  permission: false\n                });\n                window.alert(\"Sorry! you entered incorrect account\");\n\n              case 10:\n                search.value = '';\n                this.setState({\n                  loadingPatient: false\n                });\n\n              case 12:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function searchOnClick() {\n        return _searchOnClick.apply(this, arguments);\n      }\n\n      return searchOnClick;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Error, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Header, {\n        account: this.state.account,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 22\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 27\n        }\n      }), /*#__PURE__*/React.createElement(\"h4\", {\n        style: {\n          paddingLeft: \"40px\",\n          color: \"#ff9900\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 17\n        }\n      }, \"Hello \", this.state.account), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 22\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        style: {\n          textAlign: \"center\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 19\n        }\n      }, \"Searching patient by address\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"cover\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"divFrom\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"search\",\n        id: \"searchInput\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 27\n        }\n      }), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fa fa-search\",\n        onClick: this.searchOnClick,\n        onTouchEnd: this.searchOnClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 31\n        }\n      }))), this.state.loadingPatient ? /*#__PURE__*/React.createElement(LoadingPatient, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 48\n        }\n      }) : null, this.state.permission ? /*#__PURE__*/React.createElement(Redirect, {\n        push: true,\n        to: {\n          pathname: \"/ShowPatientMrc\",\n          state: {\n            patientAccount: this.state.patientAccount,\n            account: this.state.account\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 19\n        }\n      }) : null), /*#__PURE__*/React.createElement(Footer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 15\n        }\n      })));\n    }\n  }]);\n\n  return ServiceProviderHome;\n}(Component);\n\nfunction LoadingPatient() {\n  var show = useState(true);\n  return /*#__PURE__*/React.createElement(Modal, {\n    show: show,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, \"Loading..\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, \"Please wait...\")));\n}\n\nexport default ServiceProviderHome;","map":{"version":3,"sources":["C:/Users/shaii/Desktop/projects/MrC/src/components/ServiceProviderHome.js"],"names":["React","Component","useState","Redirect","Header","Footer","Error","Web3","Permissions","Modal","ServiceProviderHome","loadWeb3","loadBlockchainData","window","ethereum","web3","enable","currentProvider","alert","eth","net","getId","networkId","networkData","networks","permissions","Contract","abi","address","setState","props","state","account","localStorage","getItem","hasPermission","patientAccount","loadingPatient","hasError","searchOnClick","bind","checkPermission","undefined","methods","havePermission","call","from","check","search","document","getElementById","value","permission","paddingLeft","color","textAlign","pathname","LoadingPatient","show"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA4C,OAA5C;AACA,OAAO,2BAAP;AACA,SAASC,QAAT,QAAwB,kBAAxB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,OAAOC,KAAP,MAAkB,uBAAlB;;IAEMC,mB;;;;;;;;;;;;uBAGI,KAAKC,QAAL,E;;;;uBACA,KAAKC,kBAAL,E;;;;;;;;;;;;;;;;;;;;;;;;qBAIFC,MAAM,CAACC,Q;;;;;AACTD,gBAAAA,MAAM,CAACE,IAAP,GAAc,IAAIR,IAAJ,CAASM,MAAM,CAACC,QAAhB,CAAd;;uBACMD,MAAM,CAACC,QAAP,CAAgBE,MAAhB,E;;;;;;;AAGH,oBAAIH,MAAM,CAACE,IAAX,EAAiB;AACpBF,kBAAAA,MAAM,CAACE,IAAP,GAAc,IAAIR,IAAJ,CAASM,MAAM,CAACE,IAAP,CAAYE,eAArB,CAAd;AACD,iBAFI,MAGA;AACHJ,kBAAAA,MAAM,CAACK,KAAP,CAAa,qEAAb;AACD;;;;;;;;;;;;;;;;;;;;;;;;;AAIKH,gBAAAA,I,GAAOF,MAAM,CAACE,I;;uBACIA,IAAI,CAACI,GAAL,CAASC,GAAT,CAAaC,KAAb,E;;;AAAlBC,gBAAAA,S;AACAC,gBAAAA,W,GAAcf,WAAW,CAACgB,QAAZ,CAAqBF,SAArB,C;;AACpB,oBAAGC,WAAH,EAAgB;AACRE,kBAAAA,WADQ,GACMV,IAAI,CAACI,GAAL,CAASO,QAAT,CAAkBlB,WAAW,CAACmB,GAA9B,EAAmCJ,WAAW,CAACK,OAA/C,CADN;AAEd,uBAAKC,QAAL,CAAc;AAAEJ,oBAAAA,WAAW,EAAXA;AAAF,mBAAd;AACD,iBAHD,MAGO;AACLZ,kBAAAA,MAAM,CAACK,KAAP,CAAa,gDAAb;AACD;;;;;;;;;;;;;;;;;;AAGD,+BAAYY,KAAZ,EAAmB;AAAA;;AAAA;;AACf,6FAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACTC,MAAAA,OAAO,EAAEC,YAAY,CAACC,OAAb,CAAqB,SAArB,CADA;AAETC,MAAAA,aAAa,EAAC,KAFL;AAGTC,MAAAA,cAAc,EAAE,EAHP;AAITC,MAAAA,cAAc,EAAE,KAJP;AAKTC,MAAAA,QAAQ,EAAE;AALD,KAAb;AAOA,UAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,uDAArB;AACA,UAAKC,eAAL,GAAuB,MAAKA,eAAL,CAAqBD,IAArB,uDAAvB;AAVe;AAWhB;;;;;;;;;;;sBAGI,KAAKT,KAAL,CAAWK,cAAX,KAA8B,EAA9B,IAAoC,KAAKL,KAAL,CAAWK,cAAX,KAA8BM,S;;;;;;uBAExC,KAAKX,KAAL,CAAWN,WAAX,CAAuBkB,OAAvB,CAA+BC,cAA/B,CAA8C,KAAKb,KAAL,CAAWK,cAAzD,EAAyES,IAAzE,CAA8E;AAACC,kBAAAA,IAAI,EAAC,KAAKf,KAAL,CAAWC;AAAjB,iBAA9E,C;;;AAAfe,gBAAAA,K;;AACN,oBAAGA,KAAH,EAAS;AACL,uBAAKlB,QAAL,CAAc;AAACM,oBAAAA,aAAa,EAAC;AAAf,mBAAd;AACH,iBAFD,MAGI;AACAtB,kBAAAA,MAAM,CAACK,KAAP,CAAa,oCAAb;AACH,iB,CACR;AACG;AACA;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;AAKG8B,gBAAAA,M,GAASC,QAAQ,CAACC,cAAT,CAAwB,aAAxB,C,EACf;;AACA,qBAAKrB,QAAL,CAAc;AAACQ,kBAAAA,cAAc,EAAC;AAAhB,iBAAd;;sBACGW,MAAM,KAAKN,SAAX,IAAwBM,MAAM,CAACG,KAAP,KAAiB,E;;;;;AACxC,qBAAKtB,QAAL,CAAc;AAACO,kBAAAA,cAAc,EAAEY,MAAM,CAACG;AAAxB,iBAAd;;uBACM,KAAKV,eAAL,E;;;;;;;AAGN,qBAAKZ,QAAL,CAAc;AAAEuB,kBAAAA,UAAU,EAAE;AAAd,iBAAd;AACAvC,gBAAAA,MAAM,CAACK,KAAP,CAAa,sCAAb;;;AAEJ8B,gBAAAA,MAAM,CAACG,KAAP,GAAe,EAAf;AACA,qBAAKtB,QAAL,CAAc;AAACQ,kBAAAA,cAAc,EAAC;AAAhB,iBAAd;;;;;;;;;;;;;;;;;;6BAGK;AACL,0BACI,uDACI,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACA,oBAAC,MAAD;AAAQ,QAAA,OAAO,EAAE,KAAKN,KAAL,CAAWC,OAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADA,eAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFA,eAEK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFL,eAEU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFV,eAGA;AAAI,QAAA,KAAK,EAAE;AAACqB,UAAAA,WAAW,EAAC,MAAb;AAAoBC,UAAAA,KAAK,EAAC;AAA1B,SAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAwD,KAAKvB,KAAL,CAAWC,OAAnE,CAHA,eAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJA,eAIK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJL,eAKF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAI,QAAA,KAAK,EAAE;AAACuB,UAAAA,SAAS,EAAE;AAAZ,SAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCADJ,eAEI;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,EAAE,EAAC,aAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,eAEQ;AAAG,QAAA,SAAS,EAAC,cAAb;AACA,QAAA,OAAO,EAAE,KAAKhB,aADd;AAC6B,QAAA,UAAU,EAAE,KAAKA,aAD9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFR,CADJ,CAFJ,EASK,KAAKR,KAAL,CAAWM,cAAX,gBAA4B,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAA5B,GAAiD,IATtD,EAUK,KAAKN,KAAL,CAAWqB,UAAX,gBAED,oBAAC,QAAD;AAAU,QAAA,IAAI,MAAd;AAAe,QAAA,EAAE,EAAE;AACjBI,UAAAA,QAAQ,EAAE,iBADO;AAEjBzB,UAAAA,KAAK,EAAE;AAAEK,YAAAA,cAAc,EAAE,KAAKL,KAAL,CAAWK,cAA7B;AACPJ,YAAAA,OAAO,EAAE,KAAKD,KAAL,CAAWC;AADb;AAFU,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFC,GAOC,IAjBN,CALE,eAwBF,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAxBE,CADJ,CADJ;AA8BD;;;;EA9G2B/B,S;;AAiHlC,SAASwD,cAAT,GAA0B;AACxB,MAAMC,IAAI,GAAGxD,QAAQ,CAAC,IAAD,CAArB;AACA,sBACE,oBAAC,KAAD;AAAO,IAAA,IAAI,EAAEwD,IAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACG,oBAAC,KAAD,CAAO,MAAP;AAAc,IAAA,WAAW,MAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACS,oBAAC,KAAD,CAAO,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADT,CADH,eAII,oBAAC,KAAD,CAAO,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,CAJJ,CADF;AAUD;;AACD,eAAehD,mBAAf","sourcesContent":["import React, { Component, useState  } from 'react'\nimport './ServiceProviderHome.css'\nimport { Redirect} from \"react-router-dom\";\nimport Header from './Header';\nimport Footer from './Footer'\nimport Error from './Error'\nimport Web3 from 'web3'\nimport Permissions from '../abis/Permissions.json'\nimport Modal from 'react-bootstrap/Modal'\n\nclass ServiceProviderHome extends Component{\n    \n  async componentDidMount() {\n    await this.loadWeb3()\n    await this.loadBlockchainData()\n  }\n\n  async loadWeb3() {\n    if (window.ethereum) {\n      window.web3 = new Web3(window.ethereum)\n      await window.ethereum.enable()\n    }\n\n    else if (window.web3) {\n      window.web3 = new Web3(window.web3.currentProvider)\n    }\n    else {\n      window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!')\n    }\n  }\n\n  async loadBlockchainData() {\n    const web3 = window.web3\n    const networkId = await web3.eth.net.getId()\n    const networkData = Permissions.networks[networkId]\n    if(networkData) {\n      const permissions = web3.eth.Contract(Permissions.abi, networkData.address)\n      this.setState({ permissions })\n    } else {\n      window.alert('MrC contract not deployed to detected network.')\n    }\n  }\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            account: localStorage.getItem('account'),\n            hasPermission:false,\n            patientAccount: '',\n            loadingPatient: false,\n            hasError: false\n        }\n        this.searchOnClick = this.searchOnClick.bind(this)\n        this.checkPermission = this.checkPermission.bind(this)\n      }\n    \n    async checkPermission(){\n        if(this.state.patientAccount !== \"\" && this.state.patientAccount !== undefined){         \n          //  if(Web3.utils.isAddress(this.state.patientAccount)){\n                const check  = await this.state.permissions.methods.havePermission(this.state.patientAccount).call({from:this.state.account})\n                if(check){\n                    this.setState({hasPermission:true})\n                }\n                else{\n                    window.alert(\"Sorry! you don't have permission!!\")\n                }\n         //   }\n            //else{\n            //    window.alert(\"Please enter illegal address!\")\n           // }\n        }\n    }\n      \n    async searchOnClick(){\n        const search = document.getElementById('searchInput')\n        // check if have permission \n        this.setState({loadingPatient:true})\n        if(search !== undefined && search.value !== '' ){\n            this.setState({patientAccount: search.value})\n            await this.checkPermission()\n        }\n        else{\n            this.setState({ permission: false })\n            window.alert(\"Sorry! you entered incorrect account\")\n        }\n        search.value = ''\n        this.setState({loadingPatient:false})\n    }\n\n    render() {\n        return(\n            <>\n                <Error>\n                <Header account={this.state.account}/>\n                <br/><br/><br/>\n                <h4 style={{paddingLeft:\"40px\",color:\"#ff9900\"}}>Hello {this.state.account}</h4>\n                <br/><br/>\n              <div>\n                  <h5 style={{textAlign: \"center\"}}>Searching patient by address</h5>\n                  <div className=\"cover\">\n                      <div className=\"divFrom\" >     \n                          <input type=\"search\" id=\"searchInput\" />\n                              <i className=\"fa fa-search\"  \n                              onClick={this.searchOnClick} onTouchEnd={this.searchOnClick} ></i>\n                      </div>\n                  </div>\n                  {this.state.loadingPatient ? <LoadingPatient /> : null}\n                  {this.state.permission \n                  ?  \n                  <Redirect push to={{\n                    pathname: \"/ShowPatientMrc\",\n                    state: { patientAccount: this.state.patientAccount,\n                    account: this.state.account }\n                  }} />          \n                  : null}\n              </div>\n              <Footer/>\n              </Error>\n              </>\n          );\n      }\n}\n\nfunction LoadingPatient() {\n  const show = useState(true)\n  return (\n    <Modal show={show}>\n       <Modal.Header closeButton>\n                <Modal.Title>Loading..</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <span>Please wait...</span>\n        </Modal.Body>\n    </Modal>\n  );\n}\nexport default ServiceProviderHome;"]},"metadata":{},"sourceType":"module"}